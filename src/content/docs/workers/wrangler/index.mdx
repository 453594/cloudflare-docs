export default {
  async fetch(request) {
    if (request.method !== 'POST') {
      return new Response('Method Not Allowed', { status: 405 });
    }

    const { recipient_email, sender_email, sender_name, subject, message } = await request.json();

    const mailData = {
      personalizations: [
        {
          to: [{ email: recipient_email }],
        },
      ],
      from: { email: sender_email, name: sender_name },
      subject: subject,
      content: [
        {
          type: 'text/plain',
          value: message,
        },
      ],
    };

    const response = await fetch('https://api.mailchannels.net/tx/v1/send', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(mailData),
    });

    return new Response('Email sent', { status: response.status });
  },
};
